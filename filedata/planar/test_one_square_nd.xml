<?xml version="1.0" encoding="UTF-8"?>
<!--
This is a simple example of two squares, parametrized by linear 
B-splines meeting along one side
-->
<xml>
  <!-- Patch 0 -->
  <Geometry type="TensorBSpline2" id="500">
    <Basis type="TensorBSplineBasis2">
      <Basis type="BSplineBasis" index="0">
	<KnotVector degree="1">0 0 1 1 </KnotVector>
      </Basis>
      <Basis type="BSplineBasis" index="1">
	<KnotVector degree="1">0 0 1 1 </KnotVector>
      </Basis>
    </Basis>
    <coefs geoDim="2">
    0 0 
    0.5 0 
    0 1
    0.5 1
    2 2 
    0 1
    </coefs>
  </Geometry>
  

  <!-- Right-hand side function -->
  <Function type="FunctionExpr" id="1" dim="2">-exp(-(x-0.5)^2)*(4*x^2-4*x-1)</Function>             <!--2*pi^2*sin(pi*x)*sin(pi*y)-->

  <!-- The boundary conditions (multipatch=number of patches)-->
  <boundaryConditions id="2" multipatch="2">
      <Function type="FunctionExpr" dim="2" index="0">exp(-(x-0.5)^2)</Function>                 <!-- sin(pi*x) * sin(pi*y) -->
    <Function type="FunctionExpr" dim="2" index="1">0</Function>
    
    <!-- Dirichlet conditions (patch,side) -->
    <bc type="Dirichlet" function="0" unknown="0">
      0 3 0 4 0 1 0 2
    </bc>
    
    <!-- Neumann conditions (patch,side)-->
    <bc unknown="0" type="Neumann" function="1">
    </bc>
  </boundaryConditions>

  <!-- The manufactured exact solution (for reference) -->
  <Function type="FunctionExpr" id="3" dim="2">exp(-(x-0.5)^2)</Function>

  <!-- Assembler options -->
 <OptionList id="4">
  <int label="DirichletStrategy" desc="Method for enforcement of Dirichlet BCs [11..14]" value="11"/>
  <int label="DirichletValues" desc="Method for computation of Dirichlet DoF values [100..103]" value="101"/>
  <int label="InterfaceStrategy" desc="Method of treatment of patch interfaces [0..3]" value="1"/>
  <real label="bdA" desc="Estimated nonzeros per column of the matrix: bdA*deg + bdB" value="2"/>
  <int label="bdB" desc="Estimated nonzeros per column of the matrix: bdA*deg + bdB" value="1"/>
  <real label="bdO" desc="Overhead of sparse mem. allocation: (1+bdO)(bdA*deg + bdB) [0..1]" value="0.333"/>
  <real label="quA" desc="Number of quadrature points: quA*deg + quB" value="1"/>
  <int  label="quB" desc="Number of quadrature points: quA*deg + quB" value="1"/>
  <int label="quRule" desc="Quadrature rule [1:GaussLegendre,2:GaussLobatto]" value="1"/>

 </OptionList>
 
 

  <!-- A multipatch section describes the configuration
       of the two patches above -->
<!--  <MultiPatch parDim="1" id="0">
    <patches type="id_range">500</patches>
    <boundary>
      500 3 500 4 500 1 500 2
    </boundary>
  </MultiPatch>-->

</xml>
